{"version":3,"sources":["../../src/core/settings/pages/general/general.module.ts","../../src/core/settings/pages/general/general.ts"],"names":[],"mappings":"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","file":"23.js","sourcesContent":["// (C) Copyright 2015 Martin Dougiamas\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { CoreSettingsGeneralPage } from './general';\nimport { CoreComponentsModule } from '@components/components.module';\nimport { CoreDirectivesModule } from '@directives/directives.module';\n\n@NgModule({\n    declarations: [\n        CoreSettingsGeneralPage\n    ],\n    imports: [\n        CoreComponentsModule,\n        CoreDirectivesModule,\n        IonicPageModule.forChild(CoreSettingsGeneralPage),\n        TranslateModule.forChild()\n    ],\n})\nexport class CoreSettingsGeneralPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/settings/pages/general/general.module.ts","// (C) Copyright 2015 Martin Dougiamas\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component } from '@angular/core';\nimport { IonicPage, AlertController } from 'ionic-angular';\nimport { TranslateService } from '@ngx-translate/core';\nimport { CoreAppProvider } from '@providers/app';\nimport { CoreConstants } from '@core/constants';\nimport { CoreConfigProvider } from '@providers/config';\nimport { CoreFileProvider } from '@providers/file';\nimport { CoreEventsProvider } from '@providers/events';\nimport { CoreLangProvider } from '@providers/lang';\nimport { CoreDomUtilsProvider } from '@providers/utils/dom';\nimport { CoreLocalNotificationsProvider } from '@providers/local-notifications';\nimport { CoreConfigConstants } from '../../../../configconstants';\nimport { CoreSitesProvider } from '@providers/sites';\nimport { Network } from '@ionic-native/network';\n\n/**\n * Page that displays the general settings.\n */\n@IonicPage({segment: 'core-settings-general'})\n@Component({\n    selector: 'page-core-settings-general',\n    templateUrl: 'general.html',\n})\nexport class CoreSettingsGeneralPage {\n\n    protected onlineObserver;\n\n    languages = {};\n    languageCodes = [];\n    selectedLanguage: string;\n    baseLanguage: string;\n    rteSupported: boolean;\n    richTextEditor: boolean;\n    debugDisplay: boolean;\n\n    constructor(appProvider: CoreAppProvider, private configProvider: CoreConfigProvider, fileProvider: CoreFileProvider,\n            private eventsProvider: CoreEventsProvider, private langProvider: CoreLangProvider,\n            private domUtils: CoreDomUtilsProvider,\n            localNotificationsProvider: CoreLocalNotificationsProvider, private sitesProvider: CoreSitesProvider,\n            private alertCtrl: AlertController, private translate: TranslateService, private network: Network) {\n\n        this.languages = CoreConfigConstants.languages;\n        this.languageCodes = Object.keys(this.languages);\n        langProvider.getCurrentLanguage().then((currentLanguage) => {\n            this.baseLanguage = this.selectedLanguage = currentLanguage;\n        });\n\n        this.rteSupported = this.domUtils.isRichTextEditorSupported();\n        if (this.rteSupported) {\n            this.configProvider.get(CoreConstants.SETTINGS_RICH_TEXT_EDITOR, true).then((richTextEditorEnabled) => {\n                this.richTextEditor = !!richTextEditorEnabled;\n            });\n        }\n\n        this.configProvider.get(CoreConstants.SETTINGS_DEBUG_DISPLAY, false).then((debugDisplay) => {\n            this.debugDisplay = !!debugDisplay;\n        });\n    }\n\n    /**\n     * Called when a new language is selected.\n     */\n    languageChanged(): void {\n\n        this.changeUserLang(this.selectedLanguage).then((data) => {\n            this.changeLocalLang(data);\n        }).catch((error) => {\n            this.onlineObserver = this.network.onConnect().subscribe(() => {\n                this.languageChanged();\n                this.onlineObserver.unsubscribe();\n            });\n        });\n    }\n\n    /**\n     * Called when change User Lang success.\n     */\n    changeLocalLang(data: any): void {\n        const alert = this.alertCtrl.create({\n                message: this.translate.instant('core.settings.servenotreponse'),\n                buttons: [this.translate.instant('core.ok')]\n        });\n        let obj: any = {\n                message: '',\n                result: false\n        };\n        obj = data;\n        if (obj.result) {\n            this.baseLanguage = this.selectedLanguage;\n            this.langProvider.changeCurrentLanguage(this.selectedLanguage).finally(() => {\n                this.eventsProvider.trigger(CoreEventsProvider.LANGUAGE_CHANGED);\n            });\n        } else {\n            this.selectedLanguage = this.baseLanguage;\n            alert.present();\n        }\n    }\n\n    /**\n     * Update language for user\n     */\n    changeUserLang(language: string, siteId?: string): Promise<any[]> {\n        return this.sitesProvider.getSite(siteId).then((site) => {\n            // The get_site_info WS call won't be cached.\n            const preSets = {\n                getFromCache: false,\n                saveToCache: false\n            },\n                  data = {\n                    lang: language\n            };\n\n            return site.read('core_language_update_lang_user', data, preSets);\n        });\n    }\n\n    /**\n     * Called when the rich text editor is enabled or disabled.\n     */\n    richTextEditorChanged(): void {\n        this.configProvider.set(CoreConstants.SETTINGS_RICH_TEXT_EDITOR, this.richTextEditor ? 1 : 0);\n    }\n\n    /**\n     * Called when the debug display setting is enabled or disabled.\n     */\n    debugDisplayChanged(): void {\n        this.configProvider.set(CoreConstants.SETTINGS_DEBUG_DISPLAY, this.debugDisplay ? 1 : 0);\n        this.domUtils.setDebugDisplay(this.debugDisplay);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/settings/pages/general/general.ts"],"sourceRoot":""}